/**
 * PAPI v1.14+ Real Generated Descriptors
 *
 * This file uses descriptors generated by the PAPI CLI.
 * To regenerate descriptors for your project, run these commands:
 *
 * npm install polkadot-api
 * npx papi add polkadot --wsUrl wss://rpc.polkadot.io
 * npx papi add kusama --wsUrl wss://kusama-rpc.polkadot.io
 * npx papi add moonbeam --wsUrl wss://wss.api.moonbeam.network
 * npx papi add bifrost --wsUrl wss://hk.p.bifrost-rpc.liebi.com/ws
 * npx papi add astar --wsUrl wss://rpc.astar.network
 * npx papi
 *
 */

// Import real generated descriptors following PAPI documentation pattern
import {
  polkadot,
  kusama,
  moonbeam,
  bifrost,
  astar,
  paseo_asset_hub,
  hydration,
} from "@polkadot-api/descriptors";

// Type-safe mapping of chain keys to descriptors
const CHAIN_DESCRIPTORS: Record<string, any> = {
  polkadot,
  kusama,
  moonbeam,
  bifrost,
  astar,
  paseo_asset_hub,
  hydration,
  // Note: acala not included - will throw error if used
} as const;

type SupportedChainKey = keyof typeof CHAIN_DESCRIPTORS;

/**
 * Get the proper descriptor for a chain to use with client.getTypedApi()
 * @param chainKey - The chain identifier
 * @returns The chain descriptor for use with PAPI v1.14+ getTypedApi()
 */
export function getDescriptorForChain(chainKey: string): any {
  const key = chainKey as SupportedChainKey;
  if (key in CHAIN_DESCRIPTORS) {
    return CHAIN_DESCRIPTORS[key];
  }

  // Throw error for unsupported chains - no fallback
  throw new Error(
    `No descriptor available for chain '${chainKey}'. Supported chains: ${Object.keys(CHAIN_DESCRIPTORS).join(', ')}`
  );
}

/**
 * Get typed API for a chain using PAPI v1.14+ pattern
 * @param client - The PAPI client
 * @param chainKey - The chain identifier
 * @returns Typed API with all chain-specific types and methods
 */
export function getTypedApiForChain(client: any, chainKey: string): any {
  const descriptor = getDescriptorForChain(chainKey);
  return client.getTypedApi(descriptor);
}

// Export the descriptors for direct use if needed
export { polkadot, kusama, moonbeam, bifrost, astar, paseo_asset_hub, hydration };
export type { SupportedChainKey };

// List of chains with real descriptors vs unsupported
export const CHAINS_WITH_REAL_DESCRIPTORS = [
  "polkadot",
  "kusama",
  "moonbeam",
  "bifrost",
  "astar",
  "paseo_asset_hub",
  "hydration",
] as const;
export const UNSUPPORTED_CHAINS = ["acala"] as const;
